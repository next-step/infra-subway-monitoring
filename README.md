<p align="center">
    <img width="200px;" src="https://raw.githubusercontent.com/woowacourse/atdd-subway-admin-frontend/master/images/main_logo.png"/>
</p>
<p align="center">
  <img alt="npm" src="https://img.shields.io/badge/npm-%3E%3D%205.5.0-blue">
  <img alt="node" src="https://img.shields.io/badge/node-%3E%3D%209.3.0-blue">
  <a href="https://edu.nextstep.camp/c/R89PYi5H" alt="nextstep atdd">
    <img alt="Website" src="https://img.shields.io/website?url=https%3A%2F%2Fedu.nextstep.camp%2Fc%2FR89PYi5H">
  </a>
  <img alt="GitHub" src="https://img.shields.io/github/license/next-step/atdd-subway-service">
</p>

<br>

# ì¸í”„ë¼ê³µë°© ìƒ˜í”Œ ì„œë¹„ìŠ¤ - ì§€í•˜ì²  ë…¸ì„ ë„

<br>

## ğŸš€ Getting Started

### Install
#### npm ì„¤ì¹˜
```
cd frontend
npm install
```
> `frontend` ë””ë ‰í† ë¦¬ì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

### Usage
#### webpack server êµ¬ë™
```
npm run dev
```
#### application êµ¬ë™
```
./gradlew clean build
```
<br>


### 1ë‹¨ê³„ - ì›¹ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
1. ì›¹ ì„±ëŠ¥ì˜ˆì‚°ì€ ì–´ëŠì •ë„ê°€ ì ë‹¹í•˜ë‹¤ê³  ìƒê°í•˜ì‹œë‚˜ìš” 

```ì§€í•˜ì²  ê²½ë¡œê²€ìƒ‰ì´ ì£¼ ì„œë¹„ìŠ¤ì´ê¸°ë•Œë¬¸ì— ë¹ ë¥¸ ìƒí˜¸ì‘ìš©ì„ í™•ë³´í•˜ëŠ”ë° ìœ ë¦¬í•˜ë„ë¡ ì›¹ ì„±ëŠ¥ ì˜ˆì‚°ì„ ì„¸ìš´ë‹¤.```
#### Core Web Vitalsë³„ ìš°ì„ ìˆœìœ„ì™€ ê¸°ì¤€ ê°’ 
- FID(First Input Delay) : 100ms - ìƒí˜¸ì‘ìš©ì´ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì— 1ìˆœìœ„ë¡œ ê³ ë ¤
- LCP(Largest Contentful Paint) : 2.5s 
- CLS(Cumulative Layout Shift) : 0.1 

#### ì •ëŸ‰ ê¸°ì¤€
  - ì´ë¯¸ì§€ ìµœëŒ€í¬ê¸° 300KB ë¯¸ë§Œ
  - ê¸€ê¼´ ê°œìˆ˜ 2ê°œ ë¯¸ë§Œ
  - ë²ˆë“¤ë§ëœ JSíŒŒì¼ í¬ê¸° 500KB ë¯¸ë§Œ
  - CSS í¬ê¸° 100KB ë¯¸ë§Œ 

#### ì‹œê°„ ê¸°ì¤€
  - TTI(Time To Interactive) : 3.0s  
  - TBT(Total Blocking Time) : 300ms
  - FCP(First Contentful paint) : 1.8s (ì´íƒˆ ë°©ì§€)

#### ê·œì¹™ ê¸°ì¤€
  - light house ì ìˆ˜ 70ì  ì´ìƒ (ë„¤ì´ë²„ ì§€ë„ì˜ light house ê²°ê³¼ 78ì  + 20% ê³ ë ¤)
  - page speed ì ìˆ˜ 60ì  ì´ìƒ (ë„¤ì´ë²„ ì§€ë„ì˜ page speed ê²°ê³¼ 78ì  + 20% ê³ ë ¤)

---
  
2. ì›¹ ì„±ëŠ¥ì˜ˆì‚°ì„ ë°”íƒ•ìœ¼ë¡œ í˜„ì¬ ì§€í•˜ì²  ë…¸ì„ ë„ ì„œë¹„ìŠ¤ëŠ” ì–´ë–¤ ë¶€ë¶„ì„ ê°œì„ í•˜ë©´ ì¢‹ì„ê¹Œìš”

#### ë¹ ë¥¸ ìƒí˜¸ì‘ìš© ì‹œê°„ í™•ë³´í•˜ê¸°
  - ì¤‘ìš”í•˜ì§€ ì•Šì€ ì›¹ ë¦¬ì†ŒìŠ¤ë“¤ì€ TTI ê¸°ì¤€ ë‹¬ì„± ì´í›„ ì§€ì—° ë¡œë”©
  - ì½”ë“œ ìŠ¤í”Œë¦¬íŒ…ì„ í†µí•´ í•„ìˆ˜ì ì¸ js íŒŒì¼ë§Œì„ ìš°ì„ ì ìœ¼ë¡œ ë¡œë“œ
    - ìš”ì²­ ìˆ˜ê°€ ì¦ê°€í• ìˆ˜ ìˆì§€ë§Œ ë¹ ë¥¸ ìƒí˜¸ì‘ìš©ì„ ìœ„í•´ ìš©ì¸í•¨
  - SSRì„ í†µí•´ CSRì— ì†Œë¹„ë˜ëŠ” js ì‹¤í–‰ì‹œê°„ ê°ì†Œ
    - clientê°€ ë°›ëŠ” payloadê°€ ì»¤ì§€ê³ , server ìì›ë„ ë” ì‚¬ìš©í•˜ê² ì§€ë§Œ ë¹ ë¥¸ ìƒí˜¸ ì‘ìš©ì„ ìœ„í•´ ìš©ì¸í•¨ 
#### ë„¤íŠ¸ì›Œí¬ ë¶€ë‹´ ì¤„ì´ê¸°
  - ì´ë¯¸ì§€ ì••ì¶•, ë©”ì‹œì§€ gzip ì••ì¶•ì„ í†µí•´ payloadì˜ ìš©ëŸ‰ ê°ì†Œ
  - ì´ë¯¸ì§€, í°íŠ¸ ìºì‹±ì„ í†µí•œ ìš”ì²­ ìˆ˜ ê°ì†Œ
  
---

### 2ë‹¨ê³„ - ë¶€í•˜ í…ŒìŠ¤íŠ¸ 
1. ë¶€í•˜í…ŒìŠ¤íŠ¸ ì „ì œì¡°ê±´ì€ ì–´ëŠì •ë„ë¡œ ì„¤ì •í•˜ì…¨ë‚˜ìš” 

#### ëŒ€ìƒì‹œìŠ¤í…œë²”ìœ„
- Reverse-proxy(Nginx)
- WAS(Subway Application)
- DB(Mysql)

#### ëª©í‘œê°’ ì„¤ì • 
- [ë°ì´í„°ë¡œ ë³´ëŠ” ì„œìš¸ì‹œ ëŒ€ì¤‘êµí†µ ì´ìš©](https://www.bigdata-map.kr/datastory/traffic/seoul) í˜ì´ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ëª©í‘œê°’ì„ ì‚°ì •í•˜ì˜€ìŒ
- DAU : 264ë§Œëª… (í•˜ë£¨í‰ê·  ì´ìš©ì¸ì›ì˜ 60% ìˆ˜ì¤€)
  ```
  2021ë…„ 4ì›” ê¸°ì¤€ ì§€í•˜ì² ì„ í•˜ë£¨ í‰ê·  4,400,000ëª…ì´ ì‚¬ìš©í•¨(ìŠ¹ì°¨ì¸ì›ê¸°ì¤€)
  ```

- 1ì¸ë‹¹ 1ì¼ í‰ê·  ì ‘ì†ìˆ˜ : 1 
  ```
  (ê·¼ê±°)
  í†µê³„ìë£ŒëŠ” í•˜ë£¨ë™ì•ˆì˜ ëª¨ë“  ì—­ì—ì„œì˜ ìŠ¹ì°¨ì¸ì›ì„ ì§‘ê³„í•œê²ƒ
  ë§Œì¼ ë™ì¼ì¸ì´ í•˜ë£¨ë™ì•ˆ Aì—­, Bì—­ì—ì„œ ìŠ¹ì°¨í•œ ê²½ìš° ë‘ë²ˆ ì§‘ê³„ë˜ì—ˆì„ ê²ƒìœ¼ë¡œ ì˜ˆìƒ
  ì´ë¯¸ ì ‘ì†íšŸìˆ˜ê°€ í†µê³„ìë£Œì—ì„œ ë°˜ì˜ë˜ì–´ìˆê¸°ë•Œë¬¸ì— í‰ê·  ì ‘ì†ìˆ˜ëŠ” 1ë¡œ ì¡ì•˜ìŒ.
  ```

- ì´ˆë‹¹ í‰ê·  ì´ìš©ì : 264000 / 86400 = 30rps
- Throughput : 25 rps ~ 75 rps, Latency : 100ms
  ```
  ì¶œí‡´ê·¼ ì‹œê°„ëŒ€(08~09, 18~19)ì— ì´ìš©ì¸ì›ì´ 100ë§Œëª… ê·¼ì²˜ë¡œ ê¸‰ê²©íˆ ì¦ê°€í•˜ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  ì¶œí‡´ê·¼ ì‹œê°„ëŒ€ë¥¼ ì œì™¸í•˜ëŠ” ê²½ìš° í‰ê· ì ìœ¼ë¡œ ì‹œê°„ ë‹¹ 30ë§Œ ~ 40ë§Œëª…ì´ ì´ìš©í•˜ëŠ” ê±¸ë¡œ ë³´ì„. (ìƒˆë²½ì‹œê°„ ì œì™¸)
  ë”°ë¼ì„œ ìµœëŒ€íŠ¸ë˜í”½ê³¼ í‰ê· íŠ¸ë˜í”½ì˜ ë¹„ìœ¨ì„ ì•½ 3:1 ì •ë„ë¡œ ì •í•˜ì˜€ìŒ.
  ```

#### Vuser ì‚°ì • 
- ì‚°ì • ê²°ê³¼ : 17 users
- ì‚°ì • ê¸°ì¤€ 
  - T = (R * http_req_duration) (+ 1s)
  - R = 8, http_req_duration = 0.1s ==> T = 1.8
  - ëª©í‘œ RPS : 75
  - Vuser * 8 = 75 * 1.8
  - Vuser = 16.875 

#### ì‹œë‚˜ë¦¬ì˜¤ (R = 8)
- ë¡œê·¸ì¸
- ë‚´ì •ë³´ í™•ì¸
- ì—­ì •ë³´ ì¡°íšŒ
- ë…¸ì„ ì •ë³´ ì¡°íšŒ
- êµ¬ê°„ì •ë³´ ì¡°íšŒ
- ê²½ë¡œ ì¡°íšŒ
- ì¦ê²¨ì°¾ê¸° ì¶”ê°€
- ì¦ê²¨ì°¾ê¸° ì‚­ì œ

#### ë¶€í•˜ìœ ì§€ì‹œê°„ 
- Smoke : 10s (í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜ ì—†ëŠ”ì§€ í™•ì¸ìš©ë„)
- Load : 1m(ramp up to 17vus), 5m(17vus), 10s(ramp down 0vus) 
- Stress : 1m(20 vus) 1m(50vus) 1m(100vus) 1m(200vus..until error) 1m(ramp down 0vus)
- 
#### ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹œ ì €ì¥ë  ë°ì´í„° ê±´ìˆ˜ ë° í¬ê¸°
- ê·¸ëŸ´ë“¯í•œ ì„œë¹„ìŠ¤ ë¯¸ì…˜ì—ì„œ ì‚¬ìš©í–ˆë˜ ìš´ì˜ DB í™œìš©
  - ì—­: 616
  - ë…¸ì„ : 23
  - êµ¬ê°„ : 340
- ì¦ê²¨ì°¾ê¸°ê°€ ì§€ì†ì ìœ¼ë¡œ ì¶”ê°€ ë° ì‚­ì œ ë¨.  

---

2. Smoke, Load, Stress í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ì™€ ê²°ê³¼ë¥¼ ê³µìœ í•´ì£¼ì„¸ìš”
#### í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ 
- loadtest í´ë”ì— ìˆìŠµë‹ˆë‹¤.

#### ê²°ê³¼ ìº¡ì³
- Smoke
![smoke-grafana-1](./loadtest/result/smoke_result_grafana.png)
![smoke-grafana-2](./loadtest/result/smoke_result_grafana2.png)
![smoke-k6](./loadtest/result/smoke_result_k6.png)

- Load
![load-grafana-1](./loadtest/result/load_result_grafana.png)
![load-grafana-2](./loadtest/result/load_result_grafana2.png)
![load-k6](./loadtest/result/load_result_k6.png)

- Stress(245 VUì—ì„œ ì‘ë‹µ ì˜¤ë¥˜ ë°œìƒ)
![stress-grafana-1](./loadtest/result/stress_result_grafana.png)
![stress-grafana-2](./loadtest/result/stress_result_grafana2.png)
![stress-k6](./loadtest/result/stress_result_k6.png)

---

### 3ë‹¨ê³„ - ë¡œê¹…, ëª¨ë‹ˆí„°ë§
#### ì‘ì—…ëª©ë¡
- [X] ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ë‹¨í•˜ê¸° ì‹¤ìŠµì„ ì§„í–‰í•´ë³´ê³  ë¬¸ì œê°€ ë˜ëŠ” ì½”ë“œë¥¼ ìˆ˜ì •
  - 2ë‹¨ê³„ì—ì„œ ì§„í–‰
- [X] ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì„¤ì •í•˜ê¸°
  - bootì—ì„œ ì œê³µí•˜ëŠ” ë¡œê·¸ ê¸°ë³¸ì„¤ì • ìµœëŒ€í•œ ì¬ì‚¬ìš©(console log appender, file log appender)
  - local, test, prod profile í™œì„±í™”ì‹œ ë¡œê¹… ìš©ë„ì˜ profileë„ ê°™ì´ í™œì„±í™”(spring.profiles.groupì„ ì´ìš©)
  - JSON ë¡œê·¸ë§Œ ëª¨ì•„ì„œ ì €ì¥(Marker, Filter API ì‚¬ìš©)  
- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì ìš©í•˜ê¸° 
- [ ] actuator ë„ì…í•˜ê¸°

1. ê° ì„œë²„ë‚´ ë¡œê¹… ê²½ë¡œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”

2. Cloudwatch ëŒ€ì‹œë³´ë“œ URLì„ ì•Œë ¤ì£¼ì„¸ìš”
